2021-09-14 15:08:12.753 -05:00 [INF] Entity Framework Core 3.1.1 initialized 'PersistenceContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsHistoryTable=mySchema._MigrationHistory 
2021-09-14 15:08:24.219 -05:00 [INF] Executed DbCommand (564ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [CinemasterDb];
2021-09-14 15:08:24.341 -05:00 [INF] Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [CinemasterDb] SET READ_COMMITTED_SNAPSHOT ON;
END;
2021-09-14 15:08:24.362 -05:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-09-14 15:08:24.470 -05:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'mySchema') IS NULL EXEC(N'CREATE SCHEMA [mySchema];');
CREATE TABLE [mySchema].[_MigrationHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK__MigrationHistory] PRIMARY KEY ([MigrationId])
);
2021-09-14 15:08:24.472 -05:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-09-14 15:08:24.488 -05:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[mySchema].[_MigrationHistory]');
2021-09-14 15:08:24.492 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [mySchema].[_MigrationHistory]
ORDER BY [MigrationId];
2021-09-14 15:08:24.507 -05:00 [INF] Applying migration '20200504010842_Initial Migration'.
2021-09-14 15:08:24.536 -05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'mySchema') IS NULL EXEC(N'CREATE SCHEMA [mySchema];');
2021-09-14 15:08:24.538 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [mySchema].[OperationLog] (
    [Id] uniqueidentifier NOT NULL,
    [LogContent] nvarchar(max) NULL,
    [CreatedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    [LastModifiedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_OperationLog] PRIMARY KEY ([Id])
);
2021-09-14 15:08:24.540 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [mySchema].[Person] (
    [Id] uniqueidentifier NOT NULL,
    [FirstName] nvarchar(max) NULL,
    [LastName] nvarchar(max) NULL,
    [Email] nvarchar(max) NULL,
    [DateOfBirth] datetime2 NOT NULL,
    [CreatedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    [LastModifiedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_Person] PRIMARY KEY ([Id])
);
2021-09-14 15:08:24.543 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [mySchema].[Address] (
    [Id] uniqueidentifier NOT NULL,
    [Street] nvarchar(max) NULL,
    [Number] nvarchar(max) NULL,
    [PersonId] uniqueidentifier NOT NULL,
    [CreatedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    [LastModifiedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_Address] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Address_Person_PersonId] FOREIGN KEY ([PersonId]) REFERENCES [mySchema].[Person] ([Id]) ON DELETE CASCADE
);
2021-09-14 15:08:24.543 -05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Address_PersonId] ON [mySchema].[Address] ([PersonId]);
2021-09-14 15:08:24.546 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [mySchema].[_MigrationHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200504010842_Initial Migration', N'3.1.1');
2021-09-14 15:08:24.551 -05:00 [INF] Applying migration '20210914143259_SecondMigration'.
2021-09-14 15:08:24.554 -05:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [mySchema].[_MigrationHistory] ([MigrationId], [ProductVersion])
VALUES (N'20210914143259_SecondMigration', N'3.1.1');
2021-09-14 15:08:24.555 -05:00 [INF] Applying migration '20210914144535_ThirdMigration'.
2021-09-14 15:08:24.563 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [mySchema].[MovieShow] (
    [Id] uniqueidentifier NOT NULL,
    [Pelicula] nvarchar(max) NULL,
    [Sala] int NOT NULL,
    [Hora] datetime2 NOT NULL,
    [CreatedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    [LastModifiedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_MovieShow] PRIMARY KEY ([Id])
);
2021-09-14 15:08:24.566 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [mySchema].[Tickets] (
    [Id] uniqueidentifier NOT NULL,
    [Silla] nvarchar(max) NULL,
    [CreatedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    [LastModifiedOn] datetime2 NOT NULL DEFAULT (GETDATE()),
    [MovieShowId] uniqueidentifier NULL,
    CONSTRAINT [PK_Tickets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Tickets_MovieShow_MovieShowId] FOREIGN KEY ([MovieShowId]) REFERENCES [mySchema].[MovieShow] ([Id]) ON DELETE NO ACTION
);
2021-09-14 15:08:24.567 -05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Tickets_MovieShowId] ON [mySchema].[Tickets] ([MovieShowId]);
2021-09-14 15:08:24.567 -05:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [mySchema].[_MigrationHistory] ([MigrationId], [ProductVersion])
VALUES (N'20210914144535_ThirdMigration', N'3.1.1');
2021-09-14 15:08:24.568 -05:00 [INF] Applying migration '20210914200739_RemovePerson'.
2021-09-14 15:08:24.592 -05:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [mySchema].[Tickets] DROP CONSTRAINT [FK_Tickets_MovieShow_MovieShowId];
2021-09-14 15:08:25.003 -05:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [mySchema].[Address];
2021-09-14 15:08:25.007 -05:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [mySchema].[Person];
2021-09-14 15:08:25.107 -05:00 [INF] Executed DbCommand (99ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Tickets_MovieShowId] ON [mySchema].[Tickets];
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[mySchema].[Tickets]') AND [c].[name] = N'MovieShowId');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [mySchema].[Tickets] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [mySchema].[Tickets] ALTER COLUMN [MovieShowId] uniqueidentifier NOT NULL;
CREATE INDEX [IX_Tickets_MovieShowId] ON [mySchema].[Tickets] ([MovieShowId]);
2021-09-14 15:08:25.108 -05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [mySchema].[Tickets] ADD CONSTRAINT [FK_Tickets_MovieShow_MovieShowId] FOREIGN KEY ([MovieShowId]) REFERENCES [mySchema].[MovieShow] ([Id]) ON DELETE CASCADE;
2021-09-14 15:08:25.109 -05:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [mySchema].[_MigrationHistory] ([MigrationId], [ProductVersion])
VALUES (N'20210914200739_RemovePerson', N'3.1.1');
